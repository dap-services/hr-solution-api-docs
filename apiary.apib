FORMAT: 1A

# HR Solution API

API pro produkt HR solution.

## Allowed HTTPs requests:

- `POST` - Creates or updates a resource
- `PUT` - Updates a resource
- `GET` - Retrieves a resource or list of resources
- `DELETE` - Delete a resource

## Typical Server Responses

- 200 `OK` - The request was successful (some API calls may return 201 instead).
- 201 `Created` - The request was successful and a resource was created.
- 204 `No Content` - The request was successful but there is no representation to return (that is, the response is empty).
- 400 `Bad Request` - The request could not be understood or was missing required parameters.
- 401 `Unauthorized` - Authentication failed or user does not have permissions for the requested operation.
- 403 `Forbidden` - Access denied.
- 404 `Not Found` - Resource was not found.
- 405 `Method Not Allowed` - Requested method is not supported for the specified resource.
- 429 `Too Many Requests` - Exceeded API limits. Pause requests, wait one minute, and try again.
- 503 `Service Unavailable` - The service is temporary unavailable. Try again later.

> Čas ve všech položkách (pokud není řečeno jinak) je unix_time plus ms (http://www.epochconverter.com).

# Group

Descrition.

## Resource [/url]

### Operation [POST]

Description.

#### Práce s token

+ Request (application/json)

    + Headers

            HEADER: value

+ Response 200 (application/json)

    + Headers

            Access-Control-Allow-Origin: *

    + Body

            {"response":"string"}

# Group Account

 Práce s účtem uživatele.

## Registrace uživatele [/account/registration]

### Operation [POST]

Description.

#### Registrace uživatele

+ Request (application/json)

    + Headers

            Accept: application/json

    + Body

            {
               "first_name": "first_name  last_name",
                "email": "email",
                "phone": "333 666 999",
                "login": "login_name",
                "password": "PASSWORD",
                "verify_password": "PASSWORD"
                
            }


+ Response 200 (application/json)

    + Headers

            Access-Control-Allow-Origin: *

    + Body

            {
            "response":"Everything is ok",
            "registration":true
            }
 

+ Response 400 (application/json)

    + Headers

            Accept: application/json

    + Body

             {
             "response":"Something is not ok",
             "registration":false
             }
             
 
      
## Languages Collection [/language]

### Operation [GET]

Description.

#### List all Languages

+ Request (application/json)

    + Headers

              Access-Control-Allow-Origin: *
              

+ Response 200 (application/json)

    + Headers

            Access-Control-Allow-Origin: *

    + Body
 
 
            [{
                "id": 1,
                "description": "Angličtina",
                "i18nKey": "en"
            },{
                 
                "id": 2,
                 "description": "Čeština",
                "i18nKey": "cs"
            }] 
            
## Countries Collection [/country]

### Operation [GET]

Description.

#### List all Countries

+ Request (application/json)

    + Headers

            Access-Control-Allow-Origin: *
             

+ Response 200 (application/json)

    + Headers

            Access-Control-Allow-Origin: *

    + Body
            
            [{
                "id": 1,
                "description": "USA",
                "i18nKey": "US"
            },{
                 
                "id": 2,
                 "description": "Canada",
                "i18nKey": "CA"
            }]
            
## User detail [/account/{id}]

### Operation [GET]

Description.

#### User detail

+ Request (application/json)
    + Headers

             Access-Control-Allow-Origin: *


+ Response 200 (application/json)

    + Headers

            Access-Control-Allow-Origin: *

    + Body
            
            {
                "name_surname": "John Doe",
                "email": "johndoe@email.cz",
                "phone": "+420 111 333 555",
                "company": "Example Company",
                "street": "Sadová",
                "city": "Ostrava",
                "zip": "702 00",
                "country": "Czech Rep",
                "vat_id": "112233"
            }

## User update [/account]

### Operation [PUT]

Description.

#### User detail

+ Request (application/json)
    + Headers

             Access-Control-Allow-Origin: *
             
    + Body
    
            {
                "name_surname": "name  surname",
                "email": "email",
                "phone": "phone",
                "company": "company",
                "street": "street",
                "city": "city",
                "zip": "zip",
                "country": "country",
                "vat_id": "vat_id"
                
            }


+ Response 200 (application/json)

    + Headers

            Access-Control-Allow-Origin: *

    + Body
    
            {
             "response":"User account updated."
            }

+ Response 400 (application/json)

    + Headers

            Access-Control-Allow-Origin: *

    + Body
    
            {
             "response":"An error occured."
            }

            
## Recovery password [/account/recoverpassword]
### I need new password [POST]

Obdrzi jeden email na nemz bylo zapomenuto heslo.
Vyhleda uzivatele podle tohoto emailu, vytvori identifikacni kod a odesle email s odkazem na zmenu hesla ktery obsahuje identifikacni kod.
Pokud zadany email neexistuje nic neprovadi.
Vzdy vraci 204, aby nebylo mozne zjistovat existenci emailu v systemu.

url v emailu pro zmenu hesla je [ /passwordrecovery/newpassword?email=XXX&code=XXX ]
kde email je email pro doplneni do login page, na kterou se presmeruje po uspesne zmene hesla
a code je dlouhy retezec pro identifikaci uzivatele

+ Request

        {
            "email": "email@example.com"
        }

+ Response 204


## Users 401 messages [/test/messages]
### Users 401 messages [GET]
            
+ Response 401 (Unauthorized)

    + Header
    
            Access-Control-Allow-Origin: *
            
    + Body
    
            {
                "messages": [
                    {"i18nKey":"i18nKeyErrorMessageUnauthorized1","type":"error"},
                    {"i18nKey":"i18nKeyErrorMessageUnauthorized2","type":"error"},
                    {"i18nKey":"i18nKeyErrorMessageUnauthorized3","type":"error"}
                ]
            }                        
            
## Users Login [/account/login]
### Login User [POST]

+ Response 200 (application/json)

    + Header
            
            Access-Control-Allow-Origin: *
            
    + Body
            
            {
            "user_id": 12312334,
            "token": "security_token",
            "role":["admin","user","consultant","businessman"],
            "license":["hr1","hr2","hr3","hr4","hr5"],
            "name_surname":"John Black"
            }
            
## Users 201 message [/test/messages201]
### Users 201 message [GET]
            
+ Response 201 

    + Header
    
            Access-Control-Allow-Origin: *
            X-License-Hr4: false
            Access-Control-Expose-Headers: X-License-Hr4
            
    + Body
    
            {
                "messages": 
                    {"i18nKey":"i18nKeyCreatedMessage","type":"success"}
            } 
            
## Orders Collection [/account/{id}/orders]
### Operation [GET]
Description.

#### List all user orders

+ Request (application/json)

    + Headers

            Access-Control-Allow-Origin: *

+ Response 200 (application/json)

    + Headers

            Access-Control-Allow-Origin: *

    + Body

            [{
            "id": 1,
            "name": "Databáze lidských zdrojů",
            "insert_time": "1.11.2014",
            "valid_until": "1.1.2015",
            "status": "WAITING"
            },{
            "id": 2,
            "name": "Správný dílek do týmu",
            "insert_time": "16.10.2014",
            "valid_until": "1.1.2015",
            "status": "INVOICE"
            },{
            "id": 3,
            "name": "Zapracování",
            "insert_time": "16.10.2014",
            "valid_until": "16.12.2014",
            "status": "PAID"
            }]
            
### Operation [POST]
Create a new license orders

#### Save new license order

+ Request (application/json)

    + Headers

            Access-Control-Allow-Origin: *
            
    + Body

            {
                "invoice_items": {
                    "name": 3   
                },
                "modules":[{
                    "module_id":1,
                    "license_id":1,
                    "training":[1,2],
                    "consult_hours":5
                    },
                    {
                    "module_id":2,
                    "license_id":1,
                    "training":[3,4],
                    "consult_hours":0
                    }]
            }

+ Response 201 (application/json)

    + Headers

            Access-Control-Allow-Origin: *

    + Body

            {
                "messages": [
                {"i18nKey":"i18nKeySuccessMessageNewOrderCreated","type":"success"}
                ]
            }    
            
+ Response 400 (application/json)

    + Headers

            Accept: application/json
            Access-Control-Allow-Origin: *

    + Body

            {
                 "messages": [
                    {"i18nKey":"i18nKeyErrorMessageNewOrderNotCreated","type":"error"}
                 ]
            }   
            
## User's password change [/account/passwordchange]
### Operation [POST]
Description.

#### Store a changed user password

+ Request (application/json)

    + Headers

            Access-Control-Allow-Origin: *

+ Response 200 (application/json)

    + Headers

             Access-Control-Allow-Origin: *

    + Body
             
            {
                "messages": [
                    {"i18nKey":"i18nKeySuccessMessagePasswordChange","type":"success"}
                ]
            }
             
+ Response 400 (application/json)

    + Headers

            Accept: application/json

    + Body

             {
                 "messages": [
                    {"i18nKey":"i18nKeyErrorMessagePasswordChange","type":"error"}
                 ]
            }
            

## Download pdf [/order/{id}/invoice]
### Download [GET]

+ Response 200

    + Header

            Content-Type: application/pdf
            Content-Disposition: attachment; filename="invoice.pdf"
            Access-Control-Allow-Origin: *

    + Body

            Order invoice

## Person detail [/account/{user_id}/hr4/person/{person_id}]

### Operation [GET]

Description.

#### Show Person detail

+ Request (application/json)

    + Headers

            Access-Control-Allow-Origin: *
             

+ Response 200 (application/json)

    + Headers

            Access-Control-Allow-Origin: *
             X-License-Hr4: true
            Access-Control-Expose-Headers: X-License-Hr4

    + Body
            
            {
            "person_name": "Person name",
            "person_surname": "Person surname" ,
            "person_email":"person@seznam.cz",
            "person_position":"Boss"
            }
            
            
            
+ Response 400 (application/json)

    + Headers

            Accept: application/json
            Access-Control-Allow-Origin: *
            X-License-Hr4: true
            Access-Control-Expose-Headers: X-License-Hr4

    + Body

            [{
                 "messages":  
                    {"i18nKey":"i18nKeyErrorMessagePersonDetail","type":"error"}
                  
            }]
            
            
### Operation [PUT]

Description.

#### Save Person detail

+ Request (application/json)

    + Headers

            Access-Control-Allow-Origin: *
             
    + Body
            
            {
            "person_name": "Person name",
            "person_surname": "Person surname" ,
            "person_email":"person@seznam.cz",
            "person_position":"Boss"
            }

+ Response 200 (application/json)

    + Headers

            Access-Control-Allow-Origin: *
            X-License-Hr4: true
            Access-Control-Expose-Headers: X-License-Hr4

    + Body
             
            [{
                 "messages":  
                    {"i18nKey":"i18nKeySuccessMessagePersonDetailUpdate","type":"success"}
                  
            }]    
            
            
            
+ Response 400 (application/json)

    + Headers

            Accept: application/json
            Access-Control-Allow-Origin: *
            X-License-Hr4: true
            Access-Control-Expose-Headers: X-License-Hr4

    + Body

            [{
                 "messages":  
                    {"i18nKey":"i18nKeyErrorMessagePersonDetail","type":"error"}
                  
            }]           
            
### Operation [POST]

Description.

#### Delete Person

+ Request (application/json)

    + Headers

            Access-Control-Allow-Origin: *
             
     

+ Response 200 (application/json)

    + Headers

            Access-Control-Allow-Origin: *
            Accept: application/json
            X-License-Hr4: true
            Access-Control-Expose-Headers: X-License-Hr4

    + Body
            
            [{
                 "messages": 
                    {"i18nKey":"i18nKeySuccessMessagePersonDetailDeleted","type":"success"}
                  
            }]    
            
            
            
+ Response 400 (application/json)

    + Headers

            Accept: application/json
            Access-Control-Allow-Origin: *
            X-License-Hr4: true
            Access-Control-Expose-Headers: X-License-Hr4

    + Body

            [{
                 "messages": 
                    {"i18nKey":"i18nKeyErrorMessagePersonDetail","type":"error"}
                  
            }]           
            
            
            
## Recovery password [/account/recoverynewpassword]
### new password [POST]

request to set user's password
code - long string to recognize user
password - new password for user

+ Request (application/json)

    + Headers

            Accept: application/json

    + Body

            {
                "code": "CODE",
                "password": "PASSWORD"
            }
            
+ Response 200

    + Body
    
            {
                "messages": {
                                "i18nKey": "passwordRecoveryNewPasswordSuccess",
                                "type": "success"
                            }
            }

+ Response 400

## Users 402 Payment Required [/test/messages402]
### Users 402 Payment Required [GET]
            
+ Response 402

    + Header
    
            Access-Control-Allow-Origin: *
            
    + Body
    
            {
                "data": "data"
            }
            
## HR4 person list [/account/{id}/hr4/persons]
### Operation [GET]
Get the list of persons for hr4 model and specific user.

#### List all persons

+ Request (application/json)

    + Headers

            Access-Control-Allow-Origin: *

+ Response 200 (application/json)

    + Headers

            Access-Control-Allow-Origin: *

    + Body

            [{
            "id": 1,
            "name": "František",
            "surname": "Vomáčka",
            "position": "Kuchař",
            "diagnostic_time":"1412154655000"
            },{
            "id": 2,
            "name": "Elizabeth II.",
            "surname": "Windsor",
            "position": "Queen of the Empire",
            "diagnostic_time":null
            },{
            "id": 3,
            "name": "Silvestr",
            "surname": "Alone",
            "position": "Boxer",
            "diagnostic_time":"1406884255000"
            },{
            "id": 4,
            "name": "Arnold",
            "surname": "Schwarz",
            "position": "Krotitel predátorů",
            "diagnostic_time":null
            },{
            "id": 5,
            "name": "Elton",
            "surname": "John",
            "position": "Profesionální účastník karaoke",
            "diagnostic_time":"1409562655000"
            }]
            
            
## HR4 person results [/account/{id}/hr4/person/{id_person}/{id_result}]

### Operation [GET]
Get the list of person's results for hr4 model and specific user.

#### List person's results

+ Request (application/json)

    + Headers

            Access-Control-Allow-Origin: *

+ Response 200 (application/json)

    + Headers

            Access-Control-Allow-Origin: *
            X-License-Hr4: true
            Access-Control-Expose-Headers: X-License-Hr4

    + Body

            [{
            "result_id": 1,
            "result_date": "6.2.2014",
            "result_diagnosticurl": "http://scanner.forHrsolution.cz?code=255662",
            "status": "LICENCE"
            },{
            "result_id": 2,
            "result_date": "6.3.2014",
            "result_diagnosticurl": "http://scanner.forHrsolution.cz?code=255662",
            "status": "NORESULT"
            },{
            "result_id": 3,
            "result_date": "24.7.2014",
            "result_diagnosticurl": "http://scanner.forHrsolution.cz?code=255662",
            "status": "NOLICENCE"
            },{
            "result_id": 4,
            "result_date": "16.11.2014",
            "result_diagnosticurl": "http://scanner.forHrsolution.cz?code=255662",
            "status": "PAIDLICENCE"
            }]
            
+ Response 400 (application/json)

    + Headers

            Accept: application/json
            Access-Control-Allow-Origin: *
            X-License-Hr4: true
            Access-Control-Expose-Headers: X-License-Hr4

    + Body

            {
                 "messages": [
                    {"i18nKey":"i18nKeyErrorMessagePersonDetail","type":"error"}
                 ]
            }           
            
### Operation [POST]
Share person's result

#### Share person's result

+ Request (application/json)

    + Headers

            Access-Control-Allow-Origin: *
            
    + Body

             {
                "EmailsToShare": "person@seznam.cz,person@seznam.cz,person@seznam.cz"
                 
            }

+ Response 200 (application/json)

    + Headers

            Access-Control-Allow-Origin: *
            X-License-Hr4: true
            Access-Control-Expose-Headers: X-License-Hr4

    + Body

            {
                "messages": [
                {"i18nKey":"i18nKeySuccessMessagePersonDetailShare","type":"success"}
                ]
            }    
            
+ Response 400 (application/json)

    + Headers

            Accept: application/json
            Access-Control-Allow-Origin: *
            X-License-Hr4: true
            Access-Control-Expose-Headers: X-License-Hr4

    + Body

            {
                 "messages": [
                    {"i18nKey":"i18nKeyErrorMessagePersonDetailShare","type":"error"}
                 ]
            }    
            
### Operation [PUT]
Send email for diagnostic to the person

#### Send email whith scaner url

+ Request (application/json)

    + Headers

            Access-Control-Allow-Origin: *
            
    + Body

             {
                "person_email": "person@seznam.cz"
                 
            }

+ Response 200 (application/json)

    + Headers

            Access-Control-Allow-Origin: *
            X-License-Hr4: true
            Access-Control-Expose-Headers: X-License-Hr4

    + Body

            {
                "messages": [
                {"i18nKey":"i18nKeySuccessMessagePersonDetailDiagnosticEmail","type":"success"}
                 ] 
            }    
            
+ Response 400 (application/json)

    + Headers

            Accept: application/json
            Access-Control-Allow-Origin: *
            X-License-Hr4: true
            Access-Control-Expose-Headers: X-License-Hr4

    + Body

            {
                 "messages": [
                    {"i18nKey":"i18nKeyErrorMessagePersonDetailDiagnosticEmail","type":"error"}
                  ] 
            }           
              
### Operation [DELETE]
Delete result of person

#### Delete result of person

+ Request (application/json)

    + Headers

            Access-Control-Allow-Origin: *
            
    

+ Response 200 (application/json)

    + Headers

            Access-Control-Allow-Origin: *
            X-License-Hr4: true
            Access-Control-Expose-Headers: X-License-Hr4

    + Body

            {
                "messages":[  
                {"i18nKey":"i18nKeySuccessMessagePersonDetailDeleteResult","type":"success"}
                 ]
            }    
            
+ Response 400 (application/json)

    + Headers

            Accept: application/json
            Access-Control-Allow-Origin: *
            X-License-Hr4: true
            Access-Control-Expose-Headers: X-License-Hr4

    + Body

            {
                 "messages":[  
                    {"i18nKey":"i18nKeyErrorMessagePersonDetailDeleteResult","type":"error"}
                  ]
            }           
                  
                  
                  
## HR4 New Consultation [/account/{id}/hr4/newconsultation]

### Operation [GET]
Get New Consultation details for hr4 model.

#### New Consultation details

+ Request (application/json)

    + Headers

            Access-Control-Allow-Origin: *

+ Response 200 (application/json)

    + Headers

            Access-Control-Allow-Origin: *
            X-License-Hr4: true
            Access-Control-Expose-Headers: X-License-Hr4

    + Body

            {
            "consultationForms": [ 
             {"title":"Telefon","code":"PHONE"},
             {"title":"Osobně v DAP Services","code":"INPERSONDAPS"},
             {"title":"Osobně u nás","code":"INPERSON"}
 
             ],
             "consultationLenght":"30 min",
             "description":"hr4_new_consultation_diagnostic_description_Text"
             }
            
+ Response 400 (application/json)

    + Headers

            Accept: application/json
            Access-Control-Allow-Origin: *
            X-License-Hr4: true
            Access-Control-Expose-Headers: X-License-Hr4

    + Body

            {
                 "messages": [
                    {"i18nKey":"i18nKeyErrorMessageNewConsultation","type":"error"}
                 ]
            }           
            
### Operation [POST]
Share person's result

#### Order New Consultation

+ Request (application/json)

    + Headers

            Access-Control-Allow-Origin: *
            
    + Body

             {
                "person_id": "23",
                "result_id": "23455",
                "user_id": "12",
                "consultation_date": "12.11.20014 13:30",
                "consultation_form": "INPERSONDAPS",
                "consultation_Lenght": "30 min"
                 
            }

+ Response 201 (application/json)

    + Headers

            Access-Control-Allow-Origin: *
            X-License-Hr4: true
            Access-Control-Expose-Headers: X-License-Hr4

    + Body

            {
                "messages": [
                {"i18nKey":"i18nKeySuccessMessageNewConsultationCreated","type":"success"}
                ]
            }    
            
+ Response 400 (application/json)

    + Headers

            Accept: application/json
            Access-Control-Allow-Origin: *
            X-License-Hr4: true
            Access-Control-Expose-Headers: X-License-Hr4

    + Body

            {
                 "messages": [
                    {"i18nKey":"i18nKeyErrorMessageNewConsultationNotCreated","type":"error"}
                 ]
            }   
            
## Get module license configuration [/account/{id}/order/module/{id_module}]

### Operation [GET]
Get the list of possible licences for module

#### List person's results

+ Request (application/json)

    + Headers

            Access-Control-Allow-Origin: *

+ Response 200 (application/json)

    + Headers

            Access-Control-Allow-Origin: *
            
    + Body

            [
                {
                  "type": 1,
                  "resource_name":"order_module_license_type_half_year_license",
                  "price": 100,
                  "consultation_hours": 3,
                  "consultation_hour_price": 5,
                  "valid_until":1449229755000,
                  "training": [
                    {
                      "id": 1,
                      "training_name":"module_training_1",
                      "price": 15,
                      "required": false
                    },
                    {
                      "id": 2,
                      "training_name":"module_training_2",
                      "price": 25,
                      "required": false
                    },
                    {
                      "id": 3,
                      "training_name":"module_training_3",
                      "price": 12,
                      "required": false
                    },
                    {
                      "id": 4,
                      "training_name":"module_training_4",
                      "price": 10,
                      "required": false
                    },
                    {
                      "id": 5,
                      "training_name":"module_training_5",
                      "price": 5,
                      "required": true
                    }
                  ]
                },
                {
                  "type": 2,
                  "resource_name":"order_module_license_type_single_license",
                  "price": 4,
                  "consultation_hours": 1,
                  "consultation_hour_price": 10,
                  "training": [
                    {
                      "id": 1,
                      "training_name":"module_training_1",
                      "price": 17,
                      "required": false
                    },
                    {
                      "id": 2,
                      "training_name":"module_training_2",
                      "price": 30,
                      "required": false
                    },
                    {
                      "id": 5,
                      "training_name":"module_training_5",
                      "price": 10,
                      "required": true
                    }
                  ]
                }
              ]

+ Response 400 (application/json)

    + Headers

            Accept: application/json
            Access-Control-Allow-Origin: *

    + Body

            {
                 "messages": [
                    {"i18nKey":"i18nKeyErrorMessageModuleLicense","type":"error"}
                 ]
            }     

#Group new person
Page for create new persons and diagnostic (/hr4/newPersons)

## generate new diagnostic url[/account/{id}/hr4/persons/getNewDiagnosticUrl]
### Operation [GET]
Return unique url of diagnostic, API must manage all generated url create, delete, ...

#### Generating diagnostic url

+ Response 200 (application/json)

    + Body
        {
            diagnosticUrl: 'https://www.some.new/url/for/diagnostic'
        }

## create new persons with new diagnostics[/account/{id}/hr4/persons/create]
### Operation [POST]
Create new persons, create new diagnostics for each person and check if diagnostics urls is unique. Sends email to selected persons.
If checking diagnostic url fail it return some 40X to show error message or page with message to contact admin.

#### complete creating new persons

+ Request (application/json)

    + Body
        {
            words: ['Me', 'Work', 'Missile', 'Grandmother'],
            persons: [
                {
                    firstName: 'Karl',
                    lastName: 'Schlanshamer',
                    email: 'karlAusDeutchland@germany.de',
                    diagnosticUrl: 'https://www.some.new/url/for/diagnostic/6asd56a4f'
                },{
                    firstName: 'Sergei',
                    lastName: 'Dimitrienko',
                    email: dinitriSergei@motherrussia.ru,
                    diagnosticUrl: 'https://www.some.new/url/for/diagnostic/asf3w4687'
                }
            ]
        }
    
+ Response 200  (application/json)

    + Body
            {
                 "messages": [
                    {"i18nKey":"hr4_new_person_submit_successful","type":"success"}
                 ]
            }

+ Response 400  (application/json)

    +Body
        {
            
        }
    
